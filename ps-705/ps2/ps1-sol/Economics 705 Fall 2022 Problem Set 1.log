--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  U:\private\old-d\courses - wi\econ 705\2022 fall\\PROBLEM SETS\Economics 705 Fall 2022 Problem Set 1.log
  log type:  text
 opened on:  26 Sep 2022, 17:15:13

. *
. * ECONOMICS 705 FALL 2022 PROBLEM SET 1.DO
. * By Jeffrey Smith - Version of September 26, 2022
. * 
. * This program performs the analyses required for Problem Set 1 in 
. * Economics 705 (First Half) Fall 2022.
. *
. * READ IN THE DATA AND SUMMARIZE IT 
. *
. use "`dir'\PROBLEM SETS\Economics 705 Fall 2022 NJS Data.dta", clear

. sum

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
       bifid |     20,601    131808.6    20795.56     100110     169992
         sex |     20,601    .4568225    .4981443          0          1
         age |     20,601    29.30702    10.52068         16         82
        race |     20,601    1.646037    .8114741          1          4
     esum18i |     14,192    9513.183    9546.872          0      93951
-------------+---------------------------------------------------------
    bfyrearn |     20,601    2325.349     3834.53          0      64436
     ra_stat |     20,601     1.32178    .4671706          1          2
     bfeduca |     20,601    11.23572     2.29488          0         18
     totch18 |     20,601     1.06189     1.41126          0         20
    site_num |     20,601     8.08218    4.694295          1         16
-------------+---------------------------------------------------------
      enroll |     20,601    .4278918    .4947851          0          1
   earn_miss |     20,601    .1727101    .3780056          0          1
  child_miss |     20,601    .0942673    .2922073          0          1
     ed_miss |     20,601    .0168438    .1286893          0          1

. *
. * PROBLEM 1
. * Drop observations not in the experiment.
. *;
. keep if sex == 0
(9,411 observations deleted)

. keep if age >= 22
(3,132 observations deleted)

. *
. * PROBLEM 2
. * Generate 1/0 treatment indicator.
. *
. gen treat = 0

. replace treat = 1 if ra_stat == 1
(5,453 real changes made)

. tab ra_stat treat

           |         treat
   ra_stat |         0          1 |     Total
-----------+----------------------+----------
   Trtment |         0      5,453 |     5,453 
   Control |     2,605          0 |     2,605 
-----------+----------------------+----------
     Total |     2,605      5,453 |     8,058 

. *
. * PROBLEM 3
. * Drop if missing value of earnings in the 18 months after random 
. * assignment.
. *
. drop if esum18i == .
(2,333 observations deleted)

. *
. * PROBLEM 4
. * Summarize selected baseline variables separately for the experimental 
. * treatment and control groups.
. *
. local vlist1 age bfeduca bfyrearn

. sum `vlist1' if treat == 0

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
         age |      1,844    33.33948    9.931657         22         75
     bfeduca |      1,844    11.30043    2.412164          0         18
    bfyrearn |      1,844    1918.738    3209.271          0      30000

. sum `vlist1' if treat == 1

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
         age |      3,881    33.49343    9.924354         22         82
     bfeduca |      3,881    11.45968    2.249739          0         18
    bfyrearn |      3,881    1961.035    3262.643          0      46000

. *
. * PROBLEM 5
. * Test for differences in baseline covariates between the experimental
. * treatment and control groups.
. *
. ttest age, by(treat)

Two-sample t test with equal variances
------------------------------------------------------------------------------
   Group |     Obs        Mean    Std. err.   Std. dev.   [95% conf. interval]
---------+--------------------------------------------------------------------
       0 |   1,844    33.33948    .2312817    9.931657    32.88588    33.79308
       1 |   3,881    33.49343    .1593054    9.924354     33.1811    33.80576
---------+--------------------------------------------------------------------
Combined |   5,725    33.44384     .131187      9.9261    33.18667    33.70102
---------+--------------------------------------------------------------------
    diff |           -.1539501    .2807635               -.7043529    .3964526
------------------------------------------------------------------------------
    diff = mean(0) - mean(1)                                      t =  -0.5483
H0: diff = 0                                     Degrees of freedom =     5723

    Ha: diff < 0                 Ha: diff != 0                 Ha: diff > 0
 Pr(T < t) = 0.2917         Pr(|T| > |t|) = 0.5835          Pr(T > t) = 0.7083

. ttest bfeduca, by(treat)

Two-sample t test with equal variances
------------------------------------------------------------------------------
   Group |     Obs        Mean    Std. err.   Std. dev.   [95% conf. interval]
---------+--------------------------------------------------------------------
       0 |   1,844    11.30043    .0561728    2.412164    11.19026     11.4106
       1 |   3,881    11.45968    .0361127    2.249739    11.38887    11.53048
---------+--------------------------------------------------------------------
Combined |   5,725    11.40838    .0304544    2.304297    11.34868    11.46809
---------+--------------------------------------------------------------------
    diff |           -.1592415    .0651456               -.2869516   -.0315314
------------------------------------------------------------------------------
    diff = mean(0) - mean(1)                                      t =  -2.4444
H0: diff = 0                                     Degrees of freedom =     5723

    Ha: diff < 0                 Ha: diff != 0                 Ha: diff > 0
 Pr(T < t) = 0.0073         Pr(|T| > |t|) = 0.0145          Pr(T > t) = 0.9927

. ttest bfyrearn, by(treat)

Two-sample t test with equal variances
------------------------------------------------------------------------------
   Group |     Obs        Mean    Std. err.   Std. dev.   [95% conf. interval]
---------+--------------------------------------------------------------------
       0 |   1,844    1918.738    74.73533    3209.271    1772.163    2065.313
       1 |   3,881    1961.035    52.37183    3262.643    1858.356    2063.714
---------+--------------------------------------------------------------------
Combined |   5,725    1947.411    42.89146    3245.328    1863.328    2031.495
---------+--------------------------------------------------------------------
    diff |           -42.29672    91.79604               -222.2517    137.6583
------------------------------------------------------------------------------
    diff = mean(0) - mean(1)                                      t =  -0.4608
H0: diff = 0                                     Degrees of freedom =     5723

    Ha: diff < 0                 Ha: diff != 0                 Ha: diff > 0
 Pr(T < t) = 0.3225         Pr(|T| > |t|) = 0.6450          Pr(T > t) = 0.6775

. *
. * PROBLEM 6
. * Calculate the standardized difference for the earnings last year
. * variable.
. *
. sum bfeduca if treat == 0, detail

                           bfeduca
-------------------------------------------------------------
      Percentiles      Smallest
 1%            0              0
 5%            8              0
10%            9              0       Obs               1,844
25%           10              0       Sum of wgt.       1,844

50%           12                      Mean           11.30043
                        Largest       Std. dev.      2.412164
75%           12             17
90%           14             17       Variance       5.818535
95%           15             17       Skewness      -1.795097
99%           16             18       Kurtosis       10.62715

. sum bfeduca if treat == 1, detail

                           bfeduca
-------------------------------------------------------------
      Percentiles      Smallest
 1%            0              0
 5%            8              0
10%            9              0       Obs               3,881
25%           11              0       Sum of wgt.       3,881

50%           12                      Mean           11.45968
                        Largest       Std. dev.      2.249739
75%           12             17
90%           14             18       Variance       5.061325
95%           15             18       Skewness      -1.587118
99%           17             18       Kurtosis       10.96964

. *
. * PROBLEM 7
. * Test for a mean difference in the earnings in the 18 months after 
. * random assignment variable between the experimental treatment and 
. * control groups.
. *
. ttest esum18i, by(treat)

Two-sample t test with equal variances
------------------------------------------------------------------------------
   Group |     Obs        Mean    Std. err.   Std. dev.   [95% conf. interval]
---------+--------------------------------------------------------------------
       0 |   1,844    7470.984       180.2    7738.115    7117.567    7824.402
       1 |   3,881     8263.79    132.2658    8239.855    8004.473    8523.107
---------+--------------------------------------------------------------------
Combined |   5,725     8008.43    106.9133    8089.461     7798.84    8218.021
---------+--------------------------------------------------------------------
    diff |           -792.8057    228.5794               -1240.908   -344.7036
------------------------------------------------------------------------------
    diff = mean(0) - mean(1)                                      t =  -3.4684
H0: diff = 0                                     Degrees of freedom =     5723

    Ha: diff < 0                 Ha: diff != 0                 Ha: diff > 0
 Pr(T < t) = 0.0003         Pr(|T| > |t|) = 0.0005          Pr(T > t) = 0.9997

. *
. * PROBLEM 8
. * Calculate a simple mean difference experimental impact estimate using a 
. * linear regression.
. *
. regress esum18i treat, robust

Linear regression                               Number of obs     =      5,725
                                                F(1, 5723)        =      12.58
                                                Prob > F          =     0.0004
                                                R-squared         =     0.0021
                                                Root MSE          =     8081.7

------------------------------------------------------------------------------
             |               Robust
     esum18i | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
       treat |   792.8057    223.521     3.55   0.000       354.62    1230.991
       _cons |   7470.984   180.1826    41.46   0.000     7117.758     7824.21
------------------------------------------------------------------------------

. *
. * PROBLEM 9
. * Calculate an experimental impact estimate using a regression model that 
. * includes the baseline covariates.
. *
. local vlist2 i.race age totch18 child_miss bfeduca ed_miss bfyrearn earn_miss i.site_num

. regress esum18i treat `vlist2', robust

Linear regression                               Number of obs     =      5,725
                                                F(26, 5698)       =      23.08
                                                Prob > F          =     0.0000
                                                R-squared         =     0.1170
                                                Root MSE          =     7618.8

------------------------------------------------------------------------------
             |               Robust
     esum18i | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
       treat |    694.606   209.4014     3.32   0.001     284.0995    1105.112
             |
        race |
   Black     |  -1372.524   318.4979    -4.31   0.000    -1996.901   -748.1468
   Hispanic  |  -1188.878   447.7107    -2.66   0.008    -2066.561   -311.1943
   Other     |   237.6442   701.0889     0.34   0.735    -1136.757    1612.045
             |
         age |  -43.69301   9.964138    -4.39   0.000    -63.22651   -24.15951
     totch18 |   10.39796   75.62515     0.14   0.891    -137.8561     158.652
  child_miss |    224.997   339.4925     0.66   0.508    -440.5376    890.5315
     bfeduca |   561.4765    65.4424     8.58   0.000     433.1845    689.7685
     ed_miss |    5506.04   975.5009     5.64   0.000     3593.687    7418.393
    bfyrearn |   .6461661   .0442695    14.60   0.000      .559381    .7329512
   earn_miss |   1316.211   276.9865     4.75   0.000     773.2124     1859.21
             |
    site_num |
         CI  |   417.1486   963.5199     0.43   0.665    -1471.717    2306.014
         CV  |     883.71   548.5654     1.61   0.107    -191.6868    1959.107
         HF  |   141.5004   681.2445     0.21   0.835    -1193.998    1476.999
         IN  |   1993.828   543.8817     3.67   0.000     927.6126    3060.043
         JC  |  -113.0637    625.191    -0.18   0.856    -1338.676    1112.548
         JK  |  -221.6342   628.6226    -0.35   0.724    -1453.974    1010.705
         LC  |  -345.0588   643.6276    -0.54   0.592    -1606.814    916.6961
         MD  |   1127.085    778.386     1.45   0.148    -398.8479    2653.017
         MN  |  -1235.627   686.4295    -1.80   0.072     -2581.29    110.0359
         MT  |    19.4676    719.715     0.03   0.978    -1391.447    1430.383
         NE  |  -315.0279   568.0525    -0.55   0.579    -1428.627    798.5712
         OH  |  -2505.098   592.3865    -4.23   0.000    -3666.401   -1343.796
         OK  |   150.8803   632.6913     0.24   0.812    -1089.435    1391.196
         PR  |   597.3182   629.4329     0.95   0.343    -636.6097    1831.246
         SM  |   895.9612   596.3672     1.50   0.133    -273.1453    2065.068
             |
       _cons |   1218.393   967.3426     1.26   0.208    -677.9669    3114.752
------------------------------------------------------------------------------

. *
. * PROBLEM 10
. * Display the fraction receiving services in the treatment group and in the
. * control group.
. *
. sum enroll if treat == 1

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
      enroll |      3,881    .6588508    .4741565          0          1

. sum enroll if treat == 0

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
      enroll |      1,844    .0265727    .1608745          0          1

. *
. * PROBLEM 11
. * Obtain the instrumental variables estimate of the effect of enrolling in
. * the JTPA program using assignment to the treatment group as an instrument.
. *
. ivregress 2sls esum18i (enroll = treat), robust

Instrumental variables 2SLS regression            Number of obs   =      5,725
                                                  Wald chi2(1)    =      12.57
                                                  Prob > chi2     =     0.0004
                                                  R-squared       =     0.0008
                                                  Root MSE        =     8085.6

------------------------------------------------------------------------------
             |               Robust
     esum18i | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
      enroll |   1253.888   353.7101     3.54   0.000     560.6286    1947.147
       _cons |   7437.665   187.9514    39.57   0.000     7069.287    7806.043
------------------------------------------------------------------------------
Instrumented: enroll
 Instruments: treat

. *
. * PROBLEM 12
. * Obtain the mean of the education variable for the always-takers and the 
. * never-takers for use in constructing an estimate of the complier mean.
. *
. sum bfeduca

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
     bfeduca |      5,725    11.40838    2.304297          0         18

. sum bfeduca if treat == 0 & enroll == 1 

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
     bfeduca |         49    11.28571    2.188988          0         14

. sum bfeduca if treat == 1 & enroll == 0

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
     bfeduca |      1,324    11.39653    2.247838          0         18

. *
. * PROBLEM 13
. * Create a subgroup indicator based on age.
. *
. gen agele31 = 0

. replace agele31 = 1 if age <= 31
(3,031 real changes made)

. tab agele31, missing

    agele31 |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |      2,694       47.06       47.06
          1 |      3,031       52.94      100.00
------------+-----------------------------------
      Total |      5,725      100.00

. *
. * PROBLEM 14
. * Estimate subgroup impacts based on age using the subgroup indicator
. * created in the preceding problem. 
. *
. regress esum18i treat `vlist2' if agele31 == 1, robust

Linear regression                               Number of obs     =      3,031
                                                F(26, 3004)       =      15.07
                                                Prob > F          =     0.0000
                                                R-squared         =     0.1292
                                                Root MSE          =     7570.1

------------------------------------------------------------------------------
             |               Robust
     esum18i | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
       treat |   671.8341   290.6697     2.31   0.021     101.9024    1241.766
             |
        race |
   Black     |  -2093.648   445.4155    -4.70   0.000    -2966.999   -1220.298
   Hispanic  |  -1020.728   616.6062    -1.66   0.098    -2229.741    188.2855
   Other     |  -107.1243   1134.861    -0.09   0.925    -2332.308    2118.059
             |
         age |  -34.24605   49.81563    -0.69   0.492    -131.9222    63.43014
     totch18 |  -202.7888   109.5323    -1.85   0.064    -417.5547    11.97715
  child_miss |  -614.9002   520.2301    -1.18   0.237    -1634.944    405.1431
     bfeduca |   699.7682   103.0251     6.79   0.000     497.7614    901.7751
     ed_miss |    8415.63   1622.313     5.19   0.000     5234.673    11596.59
    bfyrearn |    .654483   .0650053    10.07   0.000     .5270236    .7819423
   earn_miss |   1410.132   367.4375     3.84   0.000     689.6773    2130.586
             |
    site_num |
         CI  |   1557.597   1409.824     1.10   0.269    -1206.721    4321.915
         CV  |   1448.719   725.8121     2.00   0.046     25.57988    2871.858
         HF  |   171.6462   841.5444     0.20   0.838    -1478.415    1821.708
         IN  |   2847.936   751.8875     3.79   0.000     1373.669    4322.202
         JC  |   503.2791   801.5803     0.63   0.530    -1068.423    2074.981
         JK  |   821.5479   802.7723     1.02   0.306    -752.4911    2395.587
         LC  |  -936.1932   875.1081    -1.07   0.285    -2652.065    779.6785
         MD  |   -24.6682   1006.661    -0.02   0.980    -1998.483    1949.146
         MN  |  -1038.692   1058.411    -0.98   0.326    -3113.976    1036.592
         MT  |    978.361   1020.631     0.96   0.338    -1022.846    2979.568
         NE  |   885.7514    765.422     1.16   0.247    -615.0528    2386.556
         OH  |  -2773.443   761.9193    -3.64   0.000    -4267.379   -1279.507
         OK  |   2467.397   950.7439     2.60   0.009     603.2224    4331.572
         PR  |    573.405   872.5355     0.66   0.511    -1137.423    2284.232
         SM  |   724.8239   800.2357     0.91   0.365    -844.2414    2293.889
             |
       _cons |  -730.0887   1760.327    -0.41   0.678    -4181.657     2721.48
------------------------------------------------------------------------------

. regress esum18i treat `vlist2' if agele31 == 0, robust

Linear regression                               Number of obs     =      2,694
                                                F(26, 2667)       =      12.52
                                                Prob > F          =     0.0000
                                                R-squared         =     0.1266
                                                Root MSE          =     7610.2

------------------------------------------------------------------------------
             |               Robust
     esum18i | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
       treat |   705.9442   301.3766     2.34   0.019     114.9888      1296.9
             |
        race |
   Black     |  -495.5682   454.7233    -1.09   0.276    -1387.214    396.0776
   Hispanic  |   -1458.64   655.5938    -2.22   0.026    -2744.164   -173.1165
   Other     |   752.5014    882.827     0.85   0.394    -978.5933    2483.596
             |
         age |  -64.15724   16.63912    -3.86   0.000    -96.78412   -31.53036
     totch18 |   120.9556   108.6238     1.11   0.266    -92.03973     333.951
  child_miss |   846.9519   453.2832     1.87   0.062    -41.87016    1735.774
     bfeduca |   432.4088   83.63581     5.17   0.000     268.4112    596.4064
     ed_miss |   3081.917   1176.816     2.62   0.009     774.3526    5389.481
    bfyrearn |    .624283   .0585325    10.67   0.000     .5095094    .7390566
   earn_miss |   1255.881   414.6719     3.03   0.002     442.7696    2068.991
             |
    site_num |
         CI  |  -986.4912   1198.756    -0.82   0.411    -3337.077    1364.094
         CV  |   357.5784   827.8209     0.43   0.666    -1265.657    1980.814
         HF  |   358.3645   1115.274     0.32   0.748    -1828.524    2545.253
         IN  |   1182.505   791.7517     1.49   0.135    -370.0042    2735.015
         JC  |  -553.7367   997.6676    -0.56   0.579    -2510.017    1402.544
         JK  |  -1537.156   1021.877    -1.50   0.133    -3540.907    466.5948
         LC  |  -71.65977   929.3001    -0.08   0.939    -1893.881    1750.562
         MD  |   2000.856   1135.527     1.76   0.078    -225.7479    4227.459
         MN  |  -1571.445   940.1313    -1.67   0.095    -3414.905    272.0151
         MT  |  -1167.472   1008.762    -1.16   0.247    -3145.507     810.562
         NE  |   -1619.51    839.986    -1.93   0.054      -3266.6    27.57972
         OH  |  -2125.916   920.8064    -2.31   0.021    -3931.483   -320.3492
         OK  |  -1686.259   872.5251    -1.93   0.053    -3397.153    24.63505
         PR  |    631.224     904.75     0.70   0.485    -1142.859    2405.306
         SM  |    1313.53   894.0187     1.47   0.142    -439.5101     3066.57
             |
       _cons |   3882.634   1489.822     2.61   0.009       961.31    6803.957
------------------------------------------------------------------------------

. gen trtle31 = treat * agele31

. regress esum18i treat trtle31 agele31 `vlist2', robust

Linear regression                               Number of obs     =      5,725
                                                F(28, 5696)       =      22.37
                                                Prob > F          =     0.0000
                                                R-squared         =     0.1185
                                                Root MSE          =     7613.9

------------------------------------------------------------------------------
             |               Robust
     esum18i | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
       treat |    715.863   302.1831     2.37   0.018     123.4691    1308.257
     trtle31 |  -44.15102   420.6668    -0.10   0.916     -868.818    780.5159
     agele31 |  -951.3589   413.7883    -2.30   0.022    -1762.541   -140.1763
             |
        race |
   Black     |  -1370.408   317.8406    -4.31   0.000    -1993.497   -747.3198
   Hispanic  |   -1184.18   447.0908    -2.65   0.008    -2060.648    -307.712
   Other     |   197.5258   699.7107     0.28   0.778    -1174.173    1569.225
             |
         age |  -82.20894   14.69207    -5.60   0.000     -111.011   -53.40689
     totch18 |  -31.83632   75.87564    -0.42   0.675    -180.5815    116.9088
  child_miss |   128.3791   340.4688     0.38   0.706    -539.0694    795.8275
     bfeduca |   556.7613   65.55509     8.49   0.000     428.2484    685.2742
     ed_miss |   5455.691   980.2282     5.57   0.000     3534.071    7377.311
    bfyrearn |    .641433   .0442601    14.49   0.000     .5546663    .7281997
   earn_miss |   1323.846   276.8043     4.78   0.000     781.2045    1866.488
             |
    site_num |
         CI  |   502.9641   964.8146     0.52   0.602     -1388.44    2394.368
         CV  |   965.1732   548.7607     1.76   0.079    -110.6065    2040.953
         HF  |   203.9227     680.28     0.30   0.764    -1129.685     1537.53
         IN  |   2072.995   543.7746     3.81   0.000      1006.99        3139
         JC  |  -38.99961   625.0626    -0.06   0.950     -1264.36    1186.361
         JK  |  -144.5129    628.221    -0.23   0.818    -1376.065    1087.039
         LC  |  -375.0511   642.6159    -0.58   0.559    -1634.823    884.7207
         MD  |   1153.728   774.6682     1.49   0.136    -364.9159    2672.373
         MN  |  -1125.116   686.9329    -1.64   0.102    -2471.765    221.5343
         MT  |   36.58543   720.7408     0.05   0.960    -1376.341    1449.512
         NE  |  -259.0858   568.5916    -0.46   0.649    -1373.742    855.5701
         OH  |  -2439.184   591.7581    -4.12   0.000    -3599.255   -1279.113
         OK  |   239.5546   632.4432     0.38   0.705    -1000.275    1479.384
         PR  |   626.2203   628.4231     1.00   0.319    -605.7282    1858.169
         SM  |    966.456   596.1769     1.62   0.105    -202.2776     2135.19
             |
       _cons |   3090.601   1144.847     2.70   0.007     846.2655    5334.937
------------------------------------------------------------------------------

. *
. * PROBLEM 15
. * Compare the standard deviations of the continuous outcome variable in the 
. * experimental treatment and control groups.
. *
. sum esum18i if treat == 1, detail

                           esum18i
-------------------------------------------------------------
      Percentiles      Smallest
 1%            0              0
 5%            0              0
10%            0              0       Obs               3,881
25%          859              0       Sum of wgt.       3,881

50%         6418                      Mean            8263.79
                        Largest       Std. dev.      8239.855
75%        13194          52240
90%        19006          52728       Variance       6.79e+07
95%        23351          57719       Skewness       1.309432
99%        34102          67156       Kurtosis       5.651694

. sum esum18i if treat == 0, detail

                           esum18i
-------------------------------------------------------------
      Percentiles      Smallest
 1%            0              0
 5%            0              0
10%            0              0       Obs               1,844
25%        295.5              0       Sum of wgt.       1,844

50%       5573.5                      Mean           7470.984
                        Largest       Std. dev.      7738.115
75%        12214          43408
90%        17894          44251       Variance       5.99e+07
95%        21348          46796       Skewness       1.237851
99%        30852          48606       Kurtosis        4.93456

. sdtest esum18i, by(treat)

Variance ratio test
------------------------------------------------------------------------------
   Group |     Obs        Mean    Std. err.   Std. dev.   [95% conf. interval]
---------+--------------------------------------------------------------------
       0 |   1,844    7470.984       180.2    7738.115    7117.567    7824.402
       1 |   3,881     8263.79    132.2658    8239.855    8004.473    8523.107
---------+--------------------------------------------------------------------
Combined |   5,725     8008.43    106.9133    8089.461     7798.84    8218.021
------------------------------------------------------------------------------
    ratio = sd(0) / sd(1)                                         f =   0.8819
H0: ratio = 1                                  Degrees of freedom = 1843, 3880

    Ha: ratio < 1               Ha: ratio != 1                 Ha: ratio > 1
  Pr(F < f) = 0.0009         2*Pr(F < f) = 0.0019           Pr(F > f) = 0.9991

. *
. * PROBLEM 16
. * Estimate a quantile treatment effect
. *
. qreg esum18i treat, q(75)
Iteration  1:  WLS sum of weighted deviations =   18025065

Iteration  1: sum of abs. weighted deviations =   18021677
Iteration  2: sum of abs. weighted deviations =   16729720
note: alternate solutions exist.
Iteration  3: sum of abs. weighted deviations =   16107150

.75 Quantile regression                             Number of obs =      5,725
  Raw sum of deviations 1.61e+07 (about 12952)
  Min sum of deviations 1.61e+07                    Pseudo R2     =     0.0012

------------------------------------------------------------------------------
     esum18i | Coefficient  Std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
       treat |       1007   396.1137     2.54   0.011     230.4672    1783.533
       _cons |      12187   326.1399    37.37   0.000     11547.64    12826.36
------------------------------------------------------------------------------

. *
. * PROBLEM 18
. * Create a binary outcome variable for any employment in the 18 months
. * after random assignment.
. *
. gen employ18 = 0

. replace employ18 = 1 if esum18i != . & esum18i != 0
(4,498 real changes made)

. tab employ18, sum(esum18i)

            |         Summary of esum18i
   employ18 |        Mean   Std. dev.       Freq.
------------+------------------------------------
          0 |           0           0       1,227
          1 |   10193.033   7811.6415       4,498
------------+------------------------------------
      Total |   8008.4304   8089.4613       5,725

. *
. * PROBLEM 19
. * Recover the joint distribution of treatment and any employment 
. * in the 18 months after random assignment.
. *
. tab treat employ18, row col cell missing

+-------------------+
| Key               |
|-------------------|
|     frequency     |
|  row percentage   |
| column percentage |
|  cell percentage  |
+-------------------+

           |       employ18
     treat |         0          1 |     Total
-----------+----------------------+----------
         0 |       433      1,411 |     1,844 
           |     23.48      76.52 |    100.00 
           |     35.29      31.37 |     32.21 
           |      7.56      24.65 |     32.21 
-----------+----------------------+----------
         1 |       794      3,087 |     3,881 
           |     20.46      79.54 |    100.00 
           |     64.71      68.63 |     67.79 
           |     13.87      53.92 |     67.79 
-----------+----------------------+----------
     Total |     1,227      4,498 |     5,725 
           |     21.43      78.57 |    100.00 
           |    100.00     100.00 |    100.00 
           |     21.43      78.57 |    100.00 

. *
. * CLOSE LOG FILE AND END.
. *
. log close
      name:  <unnamed>
       log:  U:\private\old-d\courses - wi\econ 705\2022 fall\\PROBLEM SETS\Economics 705 Fall 2022 Problem Set 1.log
  log type:  text
 closed on:  26 Sep 2022, 17:15:15
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
